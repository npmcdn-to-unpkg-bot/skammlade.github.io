---
layout: post
title: "Horsetooth Time Trial Series"
date: 2016-3-20 
categories: cycling
---
Fort Collins, CO is home to a thriving cycling scene. Your Group Ride hosts an annual time trial every Tuesday in April known as the [Horsetooth Time Trial Series][HTTT flyer]. The hilly 14.35 mile course runs along Horsetooth Reservoire and Horsetooth Mountain Park climbing a total of 1,336 feet.  


<iframe style="width:100%;height:600px;" src="https://veloviewer.com/segments/1213731/embed2" frameborder="0" scrolling="no"></iframe>


This year will be it's sixth year running and in an attempt to encourage more women to give it a try I compiled data from the previous five years to see how rider participation has differed by gender:  


![plot HTTT attendance by year and gender](/images/plot.yeargender.HTTT.png "HTTT Plot")

{% highlight r %}
attach(HTTT)

#load required packages
require(ggplot2)
require(cowplot)

#create dataframe using only year and sex variables
df<-data.frame(table(HTTT$Year,HTTT$Sex))

#barplot
p <- ggplot(df, aes(Var1, Freq, group=Var2,fill=Var2))
p <- p + geom_bar(width=0.75, 
                  position=position_dodge(width=0.78),
                  stat="identity")

#plot theme
p <- p + theme(plot.title=element_text(family="Helvetica", 
                                       face="bold", 
                                       size=36, 
                                       color="firebrick4", 
                                       vjust=20), 
               axis.text.x=element_text(family="Helvetica", 
                                        face="bold",
                                        size=18),
               axis.title.y=element_text(margin=margin(0,17,0,0), 
                                         family="Helvetica", 
                                         face="bold",
                                         size=24),
               axis.text.y=element_text(family="Helvetica", 
                                        face="bold",
                                        size=18), 
               legend.text=element_text(size=18, 
                                        face="bold"), 
               plot.margin=unit(c(0.5,0.5,0.5,0.5), "cm"))

#y axis title, plot title
p <- p + labs(y="Attendance", 
              x=NULL, 
              title="Horsetooth Time Trial Series")

#create value labels in bar
p <- p + geom_text(data=subset(df,Freq !=0),
                   aes(label=Freq), 
                   position=position_dodge(width=0.75), 
                   vjust=1.3, 
                   size=6, 
                   family="Helvetica",
                   color="white")

#remove legend title
p <- p + guides(fill=guide_legend(title=NULL))

#set y axis limits
ylim=trunc(max(df$Freq)+10)
p <- p + scale_y_continuous(limits=c(0,ylim))

#set bar colors
p <- p + scale_fill_manual(labels=c("Women","Men"),
                   values=c("firebrick4","gray25")) 

print(p)
{% endhighlight %}

Play around with the [race data][results] yourself (pulled from [YGR google docs][YGR drive]). *Note: the 2011 course differs from the 2012-2015 course and therefore times were omitted.


[results]: https://github.com/skammlade/projects/blob/master/HTTT/HTTT.csv
[YGR drive]: https://docs.google.com/spreadsheets/d/1dNnqC5YTzURecVyo8U4a_RAv-KwQoJtCwnjseIOjg1g/pub?output=html
[HTTT flyer]: http://yourgroupride.com/index.php/local-races/horsetooth-time-trial-series